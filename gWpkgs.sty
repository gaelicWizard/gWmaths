\NeedsTeXFormat{LaTeX2e}[2020/10/01]	\RequirePackage{ iftex, l3keys2e, }%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%!TeX program = pdflatexmk
%%!TEX encoding = UTF-8
%%!TEX root = gWmaths.dtx
%!TEX spellcheck = en-US
%!BIB program = biber
%!TEX parameter = -8bit
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ProvidesExplPackage
 	{gWpkgs}	{2021/01/22}	{0.0.2}%
		{COVID-19 Quarantine Accessible \TeX* Project: Package Ordering Edition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\declare@file@substitution{ifxetex.sty}{iftex.sty}
\declare@file@substitution{ifpdf.sty}{iftex.sty}
\declare@file@substitution{ifluatex.sty}{iftex.sty}
%\declare@file@substitution{ifvtex.sty}{iftex.sty}% bunchastuff
%\declare@file@substitution{ifetex.sty}{iftex.sty}% \NeedsETeX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclarePackageOrdering{ csquotes	}{after}{ gWpkgs / Class Loaded }[\pkg{csquotes} redefines \cs{quote}]
\DeclarePackageOrdering{ paralist	}{after}{ gWpkgs / Class Loaded}[\pkg{paralist} redefines several environments]
\DeclarePackageOrdering{ ntheorem	}{after}{ gWpkgs / Class Loaded}[\pkg{ntheorem} redefines several environments]

\DeclarePackageOrdering{ unicode-math	}{after}{	l3keys2e, fontspec, fix-cm, amsmath,	}[\pkg{unicode-math} \cs{RequirePackage}s these]%

\DeclarePackageOrdering{ backref	}{after}{	kvoptions, kvsetkeys, ltxcmds, rerunfilecheck,	}[\pkg{backref} \cs{RequirePackages}s these]%
\DeclarePackageOrdering{ backref	}{after}{	chicago, hyperref,	}[\pkg{backref} checks if these are loaded and modifies it's behavior]%

\DeclarePackageOrdering{ showkeys	}{incompatible-warning}{	showkeys	}[\pkg{showkeys} renders \cs{label}s and \cs{ref}s, so it steps on \pkg{hyperref}'s toes]

\DeclarePackageOrdering{ beamer	}{after}{	beamerbasemodes	}[\cls{beamer} \cs{RequirePackage}s \pkg{beamerbasemodes}]%
\DeclarePackageOrdering{ beamer	}{after}{	ifpdf, 	}[\cls{beamer} \cs{RequirePackage}s these]%
\DeclarePackageOrdering{ beamer	}{after}{	beamerbaseoptions	}[\cls{beamer} \cs{RequirePackage}s \pkg{beamerbaseoptions}]%
%beamer@autopdfinfo
%notheorems
%noamsthm
%compress
%leqno / fleqn
%handout
%trans
%ignorenonframetext
%noamssymb
%\PassOptionsToPackage{bookmarks=true, bookmarksopen=true, pdfborder={ 0 0 0}, pdfhighlight={/N}, linkbordercolor={.5 .5 .5}}{hyperref}
%pgf, hyperref, color, xcolor
%`ucs' \POTP[hyperref]{ucs}
\DeclarePackageOrdering{ beamer	}{after}{	inputenc	}[\cls{beamer} \cs{RequirePackages}s \pkg{inputenc}]
%\DeclarePackageOrdering{ beamer	}{after}{	geometry	}[\cls{beamer} \cs{RequirePackages}s \pkg{geometry}, but passes in specific \meta{papersize = \cs{beamer@paperwidth},\cs{beamer@paperheight}} \etc.]
%\beamer@filterclassoptions????
\DeclarePackageOrdering{ beamer	}{after}{	pgfcore, xxcolor, atbegshi, 	}[\cls{beamer} \cs{RequirePackages}s \pkg{pgfcore, xxcolor, atbegshi}]
\DeclarePackageOrdering{ beamer	}{after}{	hyperref	}[\cls{beamer} \cs{RequirePackages}s \pkg{hyperref} \emph{with option implicit=false}]

\DeclarePackageOrdering{ geometry	}{after}{	gWpkgs / Class Loaded	}[classes often set page geometry using primitives]%
\DeclarePackageOrdering{ fontspec	}{after}{	gWpkgs / Class Loaded	}[\pkg{fontspec} requires classes to have already defined \cs{normalfont}]%
\DeclarePackageOrdering{ fontenc	}{after}{	gWpkgs / Class Loaded	}%
\DeclarePackageOrdering{ geometry	}{after}{	gWpkgs / Class Loaded	}[classes often set page geometry using primitives]%
\DeclarePackageOrdering{ fontspec	}{after}{	gWpkgs / Class Loaded	}[\pkg{fontspec} requires classes to have already defined \cs{normalfont}]%
%\DeclarePackageOrdering{ fontenc	}{after}{	gWpkgs / Class Loaded	}%


\DeclarePackageOrdering{ accessibility	}{after}{	xkeyval,
							ifthen,	}[\cs{RequirePackage}]
\DeclarePackageOrdering{ accessibility	}{after}{	pdfcomment,
							listings,
							hyperref,
							caption, subcaption,
							tocbibind,
							tocloft,
							ragged2e,
							listings,
							etoolbox,
							parskip,
							setspace,
							cmap,
							fontenc,
							inputenc,
							hyphenat,
							babel,
							color,
							xcolor,
							natbib,
							graphicx,
							booktabs,
							textcomp,
							gensymb,
							amsfonts, ambsymb, amsmath,
							courier,
							helvet,
							mathptmx,
							geometry,
							nag,	}

%\DeclarePackageOrdering{ hyperref	}{after}{	gWpkgs / Class Loaded	}
%\DeclarePackageOrdering{ hyperxmp	}{after}{	gWpkgs / Class Loaded	}
\DeclarePackageOrdering{ hyperxmp	}{before}{	hyperref	}
\DeclarePackageOrdering{ hyperxmp	}{after}{	babel	}
\DeclarePackageOrdering{ hyperxmp	}{after}{	kvoptions,
							pdfescape,
							stringenc,
							intcalc,
							iftex,
							ifmtarg,
							etoolbox,
							ifthen,
							luacode,	}[\cs{RequirePackage}]
\DeclarePackageOrdering{ hologo		}{after}{	gWpkgs / Class Loaded	}
\DeclarePackageOrdering{ xcolor		}{before}{	gWpkgs / Class Loaded	}
\DeclarePackageOrdering{ graphicx	}{before}{	gWpkgs / Class Loaded	}
\DeclarePackageOrdering{ graphicx	}{before}{	venndiagram	}
\DeclarePackageOrdering{ venndiagram	}{after}{	tikz,
							pgf,	}[\cs{RequirePackage}]
\DeclarePackageOrdering{ varioref	}{after}{	babel }
\DeclarePackageOrdering{ bookmark	}{after}{	currfile }[uses if already loaded]
\DeclarePackageOrdering{ bookmark	}{after}{	hyperref }[loads itself without options early]
\DeclarePackageOrdering{ ntheorem	}{after}{	babel, 
							amsmath, 
							mathtools, 
							empheq, }
\DeclarePackageOrdering{ cmap		}{after}{	hyperref }
\DeclarePackageOrdering{ cmap		}{before}{	fontenc }
\DeclarePackageOrdering{ mmap		}{after}{	hyperref }
\DeclarePackageOrdering{ mmap		}{before}{	fontenc }
\DeclarePackageOrdering{ fancyhdr	}{incompatible-warning}{ accessibility }%
\DeclarePackageOrdering{ fancyhdr	}{before}{	hyperref }%
\DeclarePackageOrdering{ pdfcomment	}{after}{	hyperref }[\cs{RequirePackage}]
\DeclarePackageOrdering{ gitinfo2	}{after}{	xcolor } % uses *if* loaded
\DeclarePackageOrdering{ gitinfo2	}{after}{	etoolbox, 
							xstring, 
							kvoptions, 
							eso-pic,	}

\DeclarePackageOrdering{ nameref	}{after}{	titlesec,
							beamer,
							varioref,
							ifthen,
							listings,	}
\DeclarePackageOrdering{ nameref	}{after}{	refcount, gettitlestring, ltxcmds,	}[\pkg{nameref} \cs{RequirePackages}s these]%
\DeclarePackageOrdering{ nameref	}{after}{	showkeys, 
					hyperref,
					longtable,
					titlesec,
					amsthm,
					ifthen,
					varioref,
					listings,	}[\pkg{nameref} \cs{@ifpackageloaded} and modifies behavior, although mostly this is done via \cs{AtBeginDocument}]



\DeclarePackageOrdering{ doc		}{after}{	multicol,
							verbatim, 	}
\DeclarePackageOrdering{ hypdoc		}{after}{	doc,
							atveryend,
							calc,
							hyperref,	}[\pkg{hypdoc} heavily modifies \pkg{doc}, mostly by implementing \pkg{hyperref}.]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclarePackageOrdering{ holtxdoc	}{after}{	hypdoc,
							hyperref,
							pdftexcmds,
							ltxcmds,
							hologo,
							array,
							fontspec,
							unicode-math,	}

\RequirePackageAfterPackageIfPackage{ hypdoc }{ hyperref }{ doc }[if \pkg{doc} is already loaded when \pkg{hyperref} is loaded, then load \pkg{hypdoc}]
\RequirePackageAfterPackageIfPackage{ hypdoc }{ doc }{ hyperref }[if \pkg{hyperref} is already loaded when \pkg{doc} is loaded, then load \pkg{hypdoc}]

\DeclarePackageOrdering{ fontspec	}{before}{	fontenc	}[\pkg{fontspec} must be the one to load \pkg{fontenc}]

\ifTUTeX% engine is unicode-native, so drop \pkg{inputenc} entirely and force \pkg{fontspec} for \pkg{fontenc}
	\RequirePackageBeforePackage{ fontspec }{ fontenc }
\fi


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclarePackageOrdering{ inputenc	}{before}{	gWpkgs / Class Loaded	}[\pkg{inputenc} can affect package loading (if a file has non-ascii characters)]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclarePackageOrdering{ fixltx2e 	}{before}{	gWpkgs / Class Loaded	}
\DeclarePackageOrdering{ fancyhdr 	}{before}{	hyperref	}
\DeclarePackageOrdering{ fncychap 	}{before}{	hyperref	}
\DeclarePackageOrdering{ float 	}{before}{	hyperref	}
\DeclarePackageOrdering{ hyperref 	}{before}{	algorithm	}
\DeclarePackageOrdering{ amssymb 	}{before}{	xunicode	}
\DeclarePackageOrdering{ amssymb 	}{before}{	xltxtra	}
\DeclarePackageOrdering{ graphicx 	}{before}{	xltxtra	}
\DeclarePackageOrdering{ graphicx 	}{before}{	fontspec	}
\DeclarePackageOrdering{ caption 	}{before}{	subfig	}
\DeclarePackageOrdering{ amsmath 	}{before}{	wasysym	}
\DeclarePackageOrdering{ todonotes 	}{before}{	program	}

\DeclarePackageOrdering{ cleveref 	}{after}{	algorithm2e,
							algorithmicx,
							aliascnt,
							amsmath,
							amsthm,
							caption,
							hyperref,
							IEEEtrantools,
							listings,
							ntheorem,
							subfig,
							varioref	}

\DeclarePackageOrdering{ cleveref	}{before}{	autonum,
							hypdvips	}

\DeclarePackageOrdering{ varioref	}{before}{	hyperref	}

\DeclarePackageOrdering{ natbib		}{before}{	citeref	}

\DeclarePackageOrdering{ babel		}{before}{	apacite	}[ \pkg{babel}'s \cs{selectlanguage} redefines \cs{refname} and \cs{bibname} ]

\DeclarePackageOrdering{ hyperref	}{before}{	apacite	}[hyperref redefines citation and reference list commands]

\DeclarePackageOrdering{ hyperref	}{before}{	cmap	}[hyperref cannot write pdf settings if cmap already wrote to pdf]
% but cmap needs to load before all fonts...?

\DeclarePackageOrdering{ hyperref	}{before}{	ellipsis,
							amsrefs,
							chappg,
							dblaccnt,
							linguex	}[the hyperref documentation explicitly says to do so]

\DeclarePackageOrdering{ hyperref	}{after}{	multind,
							natbib,
							setspace	}
%because {the hyperref documentation explicitly says to do so}

\DeclarePackageOrdering{ hyperref	}{before}{	glossaries	}
%because {otherwise terms won't be clickable hyperlinks}

\DeclarePackageOrdering{ glossaries	}{after}{	babel,
							olyglossia,
							inputenc,
							fontenc,
							doc	}
%because {the glossaries documentation explicitly says to do so}

\DeclarePackageOrdering{ hyperref	}{before}{	hypcap	}
%because {hypcap redefines hyperref's caption command}

\DeclarePackageOrdering{ babel		}{before}{	selnolig	}
%because {this was recommended by selnolig's author}

\DeclarePackageOrdering{ fontenc	}{after}{	cmap,
							mmap	}
%because {otherwise some fonts may be unprocessed}

\DeclarePackageOrdering{ listingsutf8	}{after}{	listings	}
%because {it patches macros defined by listings}
% ho-tex replacement for listings; it loads listings itself

\DeclarePackageOrdering{ glossaries	}{before}{	cleveref	}[\pkg{glossaries} loads \pkg{amsmath}, which needs to be loaded before \pkg{cleveref}]

\DeclarePackageOrdering{ refenums	}{after}{	hyperref,
							cleveref,
							csquotes,
							ifthen	}[it prevents an options clash]

\DeclarePackageOrdering{ babel		}{before}{	microtype	}[microtype can use the language setting of babel]

\DeclarePackageOrdering{ hyperref	}{before}{	uri	}[uri uses hyperref's commands if hyperref is loaded]

\DeclarePackageOrdering{ url		}{before}{	uri	}[uri has a RequirePackage on url]
